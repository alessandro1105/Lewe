package com.example.servicetest;

import java.util.HashMap;

import android.os.Bundle;
import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {
	
	BroadcastReceiver bc;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_main);
		
		
		Button b1 = (Button) findViewById(R.id.button1);
		
		Button b2 = (Button) findViewById(R.id.button2);
		
		Button b3 = (Button) findViewById(R.id.button3);
		
		b1.setOnClickListener(new View.OnClickListener() {
			
			@Override
			public void onClick(View v) {
				Intent i = new Intent(MainActivity.this, MyService.class);
				
				startService(i);
				
			}
		});
		
		b2.setOnClickListener(new View.OnClickListener() {
			
			@Override
			public void onClick(View v) {
				Intent i = new Intent(MainActivity.this, MyService.class);
				
				stopService(i);
				
			}
		});
		
		b3.setOnClickListener(new View.OnClickListener() {
			
			@Override
			public void onClick(View v) {
				Intent i = new Intent(MainActivity.this, Second.class);
				
				
				
				startActivity(i);
				
			}
		});
		
		
		
		
		
		
		IntentFilter filter;
		
		filter = new IntentFilter("testIntent");
		
		//codice per update gui
	
		bc = new BroadcastReceiver() {

			@Override
			public void onReceive(Context context, Intent intent) {
				
				TextView t = (TextView) MainActivity.this.findViewById(R.id.test);

				t.setText(intent.getExtras().getString("testo"));
				
				
			}
        	
        };
        
		
		
        registerReceiver(bc, filter);
        
        
        
        HashMap h = new HashMap();
        
        h.put("e1","primo elemento");
        
        h.put("e2", 123.0);
        

        TextView t = (TextView) MainActivity.this.findViewById(R.id.test);
        
        t.setText("" +  h.get("e2"));
		
		
		
	}
	
	
	
	@Override
	public void onDestroy() {
		
		unregisterReceiver(bc);

	
		super.onDestroy();
	}
	
	

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.main, menu);
		return true;
	}
	
	
	

}
