package com.example.servicetest;

import java.sql.Timestamp;
import java.util.Collection;
import java.util.Date;
import java.util.HashMap;
import java.util.Set;

import android.os.Bundle;
import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {
	
	BroadcastReceiver bc;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_main);
		
		
		Button b1 = (Button) findViewById(R.id.button1);
		
		Button b2 = (Button) findViewById(R.id.button2);
		
		Button b3 = (Button) findViewById(R.id.button3);
		
		b1.setOnClickListener(new View.OnClickListener() {
			
			@Override
			public void onClick(View v) {
				Intent i = new Intent(MainActivity.this, MyService.class);
				
				startService(i);
				
			}
		});
		
		b2.setOnClickListener(new View.OnClickListener() {
			
			@Override
			public void onClick(View v) {
				Intent i = new Intent(MainActivity.this, MyService.class);
				
				stopService(i);
				
			}
		});
		
		b3.setOnClickListener(new View.OnClickListener() {
			
			@Override
			public void onClick(View v) {
				Intent i = new Intent(MainActivity.this, Second.class);
				
				
				
				startActivity(i);
				
			}
		});
		
		
		
		
		
		
		IntentFilter filter;
		
		filter = new IntentFilter("testIntent");
		
		//codice per update gui
	
		bc = new BroadcastReceiver() {

			@Override
			public void onReceive(Context context, Intent intent) {
				
				TextView t = (TextView) MainActivity.this.findViewById(R.id.test);

				t.setText(intent.getExtras().getString("testo"));
				
				
			}
        	
        };
        
		
		
        registerReceiver(bc, filter);
        
        
        
        HashMap<String, Object> h = new HashMap<String, Object>();
        
        h.put("e1","primo elemento");
        
        h.put("e2", 'c');
        

        TextView t = (TextView) MainActivity.this.findViewById(R.id.test);
        
        
        
        
        for (String key :  h.keySet())  {
        	
        	t.setText(" " + t.getText() + key);
        	  	
        }
        
        //t.setText("" +  h.keySet().iterator().);
        
       // h.
        
        /*
        
        
        t.setText("" +  (String) h.keySet().iterator().next());
        
        h.keySet().iterator().hasNext(); 
        
        t.setText(" " + t.getText() + (String) h.keySet().iterator().next());
        
        
        //h.keySet().iterator().toString()
        
        //(h.keySet().iterator())
        
        /*
        for(Object e : h.values()) {
        	
        	for(Object i : (Collection) e) {
        		
        		t.setText("" + t.getText() + );
        	}
        	
        	
        	
        }
        
        t.setText("" +  h.values());
        
        
		*/
		
        
        Jack j = new Jack(null) {

			@Override
			public void onReceive(JData message) {
				// TODO Auto-generated method stub
				
			}
        	
        };
        
        
        JData jd = new JData();
        
        jd.add("test", true);
        
        t.setText("Ciao".substring(0, "Ciao".length()-1));
        
        
        
        /*
        Date date = new Date();
        
        Timestamp tm = new Timestamp(date.getTime());
        
        t.setText("" + System.currentTimeMillis());
        */
        
        
        
		
	}

	
	
	





	@Override
	public void onDestroy() {
		
		unregisterReceiver(bc);

	
		super.onDestroy();
	}
	
	

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.main, menu);
		return true;
	}
	
	
	

}
